!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common/http"),require("@angular/core"),require("@angular/forms"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("ngx-summernote",["exports","@angular/common/http","@angular/core","@angular/forms","rxjs","rxjs/operators"],t):t((e=e||self)["ngx-summernote"]={},e.ng.common.http,e.ng.core,e.ng.forms,e.rxjs,e.rxjs.operators)}(this,(function(e,t,n,o,r,i){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var a=function(){return(a=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function s(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function u(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}var l=function(e){return $.summernote.ui.button({contents:'<i class="note-icon-frame" style="margin-right: 4px"></i> Code block',tooltip:"Add code block",container:".note-editor",className:"note-btn",click:function(){var t=null;window.getSelection&&(t=window.getSelection().toString().replace(/^\s+|\s+$/g,""));var n='<pre class="code-block" style="font-family: Menlo, Monaco, Consolas, \'Courier New\', monospace;\nfont-size: 12px;\npadding: 14px 12px;\nmargin-bottom: 12px;\nline-height: 1.42857;\nword-break: break-all;\noverflow-wrap: break-word;\nbackground-color: rgb(250, 251, 253);\nborder: 1px solid rgb(234, 236, 240);\nborder-radius: 4px; color: #60a0b0;\nwhite-space: pre-wrap;">'+(t||"Place your code here.")+"</pre>";e.invoke("editor.pasteHTML",n)}}).render()},c=function(){function e(e,t,o){this.el=e,this.zone=t,this.http=o,this.summernoteModelChange=new n.EventEmitter,this.imageUpload=new n.EventEmitter,this.mediaDelete=new n.EventEmitter,this.blur=new n.EventEmitter,this._options={},this.SPECIAL_TAGS=["img","button","input","a"],this.INNER_HTML_ATTR="innerHTML",this._oldModel=null,this.onChange=function(e){},this.onTouched=function(){};var r=e.nativeElement;-1!==this.SPECIAL_TAGS.indexOf(r.tagName.toLowerCase())&&(this._hasSpecialTag=!0),this.zone=t}return Object.defineProperty(e.prototype,"ngxSummernote",{set:function(e){var t=this;e&&(e.buttons||(e.buttons={}),e.callbacks=a({},e.callbacks,{onImageUpload:function(e){return t.uploadImage(e)},onMediaDelete:function(e){return t.mediaDelete.emit({url:$(e[0]).attr("src")})}}),e.buttons.codeBlock=l,Object.assign(this._options,e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"summernoteModel",{set:function(e){this.updateEditor(e)},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.createEditor()},e.prototype.ngOnChanges=function(e){this._editorInitialized&&e&&e.ngxSummernoteDisabled&&!e.ngxSummernoteDisabled.firstChange&&e.ngxSummernoteDisabled.currentValue!==e.ngxSummernoteDisabled.previousValue&&(e.ngxSummernoteDisabled.currentValue?this._$element.summernote("disable"):this._$element.summernote("enable"))},e.prototype.ngOnDestroy=function(){this.destroyEditor(),this.uploadSub&&this.uploadSub.unsubscribe()},e.prototype.writeValue=function(e){this.updateEditor(e)},e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.updateEditor=function(e){JSON.stringify(this._oldModel)!==JSON.stringify(e)&&(this._oldModel=e,this._editorInitialized?this._$element.summernote("code",e):this._$element.html(e))},e.prototype.updateModel=function(e){var t=this;this.zone.run((function(){var n=null;if(t._hasSpecialTag){for(var o=t._$element[0].attributes,r={},i=0;i<o.length;i++){var a=o[i].name;t._options.angularIgnoreAttrs&&-1!==t._options.angularIgnoreAttrs.indexOf(a)||(r[a]=o[i].value)}t._$element[0].innerHTML&&(r[t.INNER_HTML_ATTR]=t._$element[0].innerHTML),n=r}else{var s=e||"";"string"==typeof s&&(n=s)}t._oldModel!==n&&(t._oldModel=n,t.summernoteModelChange.emit(n),t.onChange(e))}))},e.prototype.initListeners=function(){var e=this;this._$element&&(this._$element.on("summernote.init",(function(){setTimeout((function(){e.updateModel()}),0)})),this._$element.on("summernote.change",(function(t,n,o){setTimeout((function(){e.updateModel(n)}),0)})),this._$element.on("summernote.blur",(function(){setTimeout((function(){e.onTouched(),e.blur.emit()}),0)})),this._options.immediateAngularModelUpdate&&this._editor.on("keyup",(function(){setTimeout((function(){e.updateModel()}),0)})))},e.prototype.createEditor=function(){var e=this;if(!this._editorInitialized){this.setContent(!0);try{this._$element=$(this.el.nativeElement)}catch(e){console.log("JQuery seems not te loaded yet! Wait 50ms and try again")}this._$element?(this.zone.runOutsideAngular((function(){e._editor=e._$element.summernote(e._options).data("summernote").$note,e.initListeners(),e.ngxSummernoteDisabled&&e._$element.summernote("disable")})),this._editorInitialized=!0):setTimeout((function(){e.createEditor()}),50)}},e.prototype.setHtml=function(){this._$element.summernote("code",this._model||"",!0)},e.prototype.setContent=function(e){void 0===e&&(e=!1);if(this._model||""===this._model)if(this._oldModel=this._model,this._hasSpecialTag){var t=this._model;if(t){for(var n in t)t.hasOwnProperty(n)&&n!==this.INNER_HTML_ATTR&&this._$element.attr(n,t[n]);t.hasOwnProperty(this.INNER_HTML_ATTR)&&(this._$element[0].innerHTML=t[this.INNER_HTML_ATTR])}}else this.setHtml()},e.prototype.destroyEditor=function(){this._editorInitialized&&(this._editor.off("keyup"),this._$element.summernote("destroy"),this._editorInitialized=!1)},e.prototype.uploadImage=function(e){return t=this,n=void 0,a=function(){var t,n,o,a,l,c,m,p,d=this;return s(this,(function(s){if(this._options.uploadImagePath){this.imageUpload.emit({uploading:!0}),o=[];try{for(a=u(e),l=a.next();!l.done;l=a.next())c=l.value,(m=new FormData).append("image",c),p=this.http.post(this._options.uploadImagePath,m,this._options.uploadImageRequestOptions).pipe(i.map((function(e){return e&&"string"==typeof e.path&&e.path}))),o.push(p)}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}this.uploadSub=r.combineLatest(o).subscribe((function(e){var t,n;try{for(var o=u(e),r=o.next();!r.done;r=o.next()){var i=r.value;d._$element.summernote("insertImage",i)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}d.imageUpload.emit({uploading:!1})}),(function(t){return d.insertFromDataURL(e)}))}else this.insertFromDataURL(e);return[2]}))},new((o=void 0)||(o=Promise))((function(e,r){function i(e){try{u(a.next(e))}catch(e){r(e)}}function s(e){try{u(a.throw(e))}catch(e){r(e)}}function u(t){t.done?e(t.value):new o((function(e){e(t.value)})).then(i,s)}u((a=a.apply(t,n||[])).next())}));var t,n,o,a},e.prototype.insertFromDataURL=function(e){var t,n,o=this,r=function(e){var t=new FileReader;t.readAsDataURL(e),t.onload=function(){o._$element.summernote("insertImage",t.result),o.imageUpload.emit({uploading:!1,encoding:"base64"})},t.onerror=function(e){return console.error(e)}};try{for(var i=u(e),a=i.next();!a.done;a=i.next()){r(a.value)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.decorators=[{type:n.Directive,args:[{selector:"[ngxSummernote]",providers:[{provide:o.NG_VALUE_ACCESSOR,useExisting:n.forwardRef((function(){return e})),multi:!0}]}]}],e.ctorParameters=function(){return[{type:n.ElementRef},{type:n.NgZone},{type:t.HttpClient}]},e.propDecorators={ngxSummernote:[{type:n.Input}],summernoteModel:[{type:n.Input}],summernoteModelChange:[{type:n.Output}],imageUpload:[{type:n.Output}],mediaDelete:[{type:n.Output}],blur:[{type:n.Output}],ngxSummernoteDisabled:[{type:n.Input}]},e}();var m=function(){function e(e,t){this.renderer2=e,this._element=t.nativeElement}return Object.defineProperty(e.prototype,"ngxSummernoteView",{set:function(e){this._element.innerHTML=e||""},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){this.renderer2.addClass(this._element,"ngx-summernote-view")},e.decorators=[{type:n.Directive,args:[{selector:"[ngxSummernoteView]"}]}],e.ctorParameters=function(){return[{type:n.Renderer2},{type:n.ElementRef}]},e.propDecorators={ngxSummernoteView:[{type:n.Input}]},e}();var p=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[]}},e.decorators=[{type:n.NgModule,args:[{declarations:[c,m],exports:[c,m]}]}],e}();e.NgxSummernoteDirective=c,e.NgxSummernoteModule=p,e.NgxSummernoteViewDirective=m,e.codeBlockButton=l,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-summernote.umd.min.js.map